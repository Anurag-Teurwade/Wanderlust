<% layout("/layouts/boilerplate") %>

<div class="filters-main">
  <div id="filters">
    <button class="scroll-btn scroll-btn-left hidden">
      <i class="fa-solid fa-chevron-left"></i>
    </button>

    <div class="filter-width">
      <% ['Trending', 'Beachfront', 'Farms', 'OMG', 'Lake', 'Design', 'Pools', 'City', 'Rooms', 'Lakefront', 'Tiny', 'Countryside', 'Cabins', 'Treehouse', 'Tropical', 'Parks', 'Castles', 'Camping', 'World', 'Luxe'].forEach((label, i) => { %>
        <a href="/listings/filter/<%= label.toLowerCase() || 'all' %>">
          <div class="filter">
            <div><i class="fa-solid <%= ['fa-fire', 'fa-umbrella-beach', 'fa-tractor', 'fa-space-awesome', 'fa-water', 'fa-fort-awesome', 'fa-person-swimming', 'fa-city', 'fa-person-booth', 'fa-cloudflare', 'fa-house-user', 'fa-mountain-sun', 'fa-house-chimney-window', 'fa-tree', 'fa-house-fire', 'fa-democrat', 'fa-fort-awesome', 'fa-tents', 'fa-square-person-confined', 'fa-building-user'][i] %>"></i></div>
            <p><%= label %></p>
          </div>
        </a>
      <% }) %>
    </div>

    <button class="scroll-btn scroll-btn-right">
      <i class="fa-solid fa-chevron-right"></i>
    </button>

    <div class="tax-toggle-container">
      <div class="tax-toggle">
        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" id="taxSwitch">
        </div>
        <span class="tax-text">Show total price</span>
      </div>
    </div>
  </div>
</div>

<div class="listing-grid">
  <% allListings.forEach(listing => { %>
    <div class="listing-card">
      <a href="/listings/<%= listing._id %>" class="listing-link">
        <div class="card-image-container">
          <img src="<%= listing.image.url %>" class="card-image" alt="<%= listing.title %>">
        </div>
        <div class="card-content">
          <h3 class="card-title"><%= listing.title %></h3>
          <div class="card-location">
            <i class="fa-solid fa-location-dot"></i>
            <%= listing.country %>
          </div>
          <div class="card-price">
            &#8377;<%= listing.price.toLocaleString("en-IN") %>
            <span class="price-per-night">/ night</span>
          </div>
          <div class="tax-info">
            + &#8377;<%= (listing.price * 0.18).toLocaleString("en-IN") %> taxes<br>
            <span class="total-price">&#8377;<%= (listing.price * 1.18).toLocaleString("en-IN") %> total</span>
          </div>
        </div>
      </a>
      <button class="wishlist-button">
        <i class="ri-heart-line"></i>
      </button>
    </div>
  <% }) %>
</div>

<script>
  setTimeout(() => {
    document.querySelectorAll(".alert").forEach(alert => {
      alert.classList.remove("show");
      alert.classList.add("hide");
    });
  }, 3000);
</script>
